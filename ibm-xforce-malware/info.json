{
  "name": "ibm-xforce-malware",
  "label": "IBM X-Force Malware",
  "description": "Retrieves details on malware identified by name, family or file hash.",
  "publisher": "Community",
  "cs_approved": true,
  "cs_compatible": true,
  "version": "1.0.0",
  "category": "Threat Intelligence",
  "icon_small_name": "small.png",
  "icon_large_name": "large.png",
  "help_online": "",
  "configuration": {
    "fields": [
      {
        "title": "Server URL",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "text",
        "name": "server_url",
        "value": "https://api.xforce.ibmcloud.com"
      },
      {
        "title": "API Key",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "password",
        "name": "api_key"
      },
      {
        "title": "API Password",
        "required": true,
        "editable": true,
        "visible": true,
        "type": "password",
        "name": "api_password"
      },
      {
        "title": "Verify SSL",
        "required": false,
        "editable": true,
        "visible": true,
        "type": "checkbox",
        "name": "verify_ssl",
        "value": true
      }
    ]
  },
  "operations": [
    {
      "operation": "get_malware_for_file_hash",
      "title": "Get Malware for File Hash",
      "description": "Returns a malware report for the given file hash, For example, md5, sha1 and sha256.",
      "category": "investigation",
      "annotation": "get_malware_for_file_hash",
      "output_schema": {
        "malware": {
          "origins": {
            "emails": {},
            "CnCServers": {
              "rows": [
                {
                  "type": "",
                  "md5": "",
                  "domain": "",
                  "firstseen": "",
                  "lastseen": "",
                  "ip": "",
                  "count": "",
                  "schema": "",
                  "filepath": "",
                  "origin": "",
                  "uri": ""
                }
              ],
              "count": ""
            },
            "downloadServers": {},
            "subjects": {},
            "external": {
              "source": "",
              "firstSeen": "",
              "lastSeen": "",
              "malwareType": "",
              "platform": "",
              "detectionCoverage": "",
              "family": [
                ""
              ]
            }
          },
          "type": "",
          "md5": "",
          "hash": "",
          "created": "",
          "family": [
            ""
          ],
          "familyMembers": {
            "tsunami": {
              "count": ""
            }
          },
          "risk": ""
        },
        "tags": []
      },
      "parameters": [
        {
          "title": "File Hash",
          "name": "filehash",
          "visible": true,
          "required": true,
          "editable": true,
          "type": "text",
          "placeholder": "md5, sha1 or sha256",
          "tooltip": "Specify the file hash of the malware. For example, md5, sha1 and sha256.",
          "description": "Specify the file hash of the malware. For example, md5, sha1 and sha256."
        }
      ],
      "enabled": true
    },
    {
      "operation": "get_malware_for_family",
      "title": "Get Malware for Family",
      "description": "Returns the malware associated with the entered family.",
      "category": "investigation",
      "annotation": "get_malware_for_family",
      "output_schema": {
        "count": "",
        "family": [
          ""
        ],
        "firstseen": "",
        "lastseen": "",
        "malware": [
          {
            "created": "",
            "family": [
              ""
            ],
            "md5": "",
            "type": ""
          }
        ]
      },
      "parameters": [
        {
          "title": "Family Name",
          "name": "family",
          "visible": true,
          "required": true,
          "editable": true,
          "type": "text",
          "placeholder": "tsunami",
          "tooltip": "Specify the malware family, For example, tsunami",
          "description": "Specify the malware family, For example, tsunami"
        }
      ],
      "enabled": true
    },
    {
      "operation": "wildcard_search_malware_family",
      "title": "Wildcard Search Malware Family",
      "description": "Returns the malware associated with the entered family.",
      "category": "investigation",
      "annotation": "wildcard_search_malware_family",
      "output_schema": {
        "count": "",
        "family": [
          ""
        ],
        "firstseen": "",
        "lastseen": "",
        "malware": [
          {
            "created": "",
            "family": [
              ""
            ],
            "md5": "",
            "type": ""
          }
        ]
      },
      "parameters": [
        {
          "title": "Family Name",
          "name": "family",
          "visible": true,
          "required": true,
          "editable": true,
          "type": "text",
          "placeholder": "Adw*",
          "tooltip": "Specify the search term, for example: Adw*.",
          "description": "Specify the search term, for example: Adw*."
        }
      ],
      "enabled": true
    }
  ]
}
